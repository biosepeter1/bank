{"version":3,"sources":["../../../../src/modules/kyc/config/kyc-country.config.ts"],"sourcesContent":["export interface KycCountryRequirement {\r\n  country: string;\r\n  countryCode: string;\r\n  idTypes: {\r\n    value: string;\r\n    label: string;\r\n    required: boolean;\r\n  }[];\r\n  requiredDocuments: {\r\n    idDocument: boolean;\r\n    proofOfAddress: boolean;\r\n    selfie: boolean;\r\n  };\r\n  addressFields: {\r\n    postalCode: boolean;\r\n    state: boolean;\r\n    city: boolean;\r\n  };\r\n  minAge: number;\r\n  additionalValidation?: {\r\n    idNumberPattern?: RegExp;\r\n    idNumberLength?: number;\r\n  };\r\n}\r\n\r\nexport const KYC_COUNTRY_REQUIREMENTS: Record<string, KycCountryRequirement> = {\r\n  // Nigeria\r\n  NG: {\r\n    country: 'Nigeria',\r\n    countryCode: 'NG',\r\n    idTypes: [\r\n      { value: 'NIN', label: 'National Identification Number', required: true },\r\n      { value: 'BVN', label: 'Bank Verification Number', required: false },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n      { value: 'VOTERS_CARD', label: \"Voter's Card\", required: false },\r\n      { value: 'INTERNATIONAL_PASSPORT', label: 'International Passport', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: false, // Not commonly used in Nigeria\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n    additionalValidation: {\r\n      idNumberLength: 11, // NIN is 11 digits\r\n    },\r\n  },\r\n\r\n  // United States\r\n  US: {\r\n    country: 'United States',\r\n    countryCode: 'US',\r\n    idTypes: [\r\n      { value: 'SSN', label: 'Social Security Number', required: true },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n      { value: 'STATE_ID', label: 'State ID', required: false },\r\n      { value: 'PASSPORT', label: 'US Passport', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: true, // ZIP code\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n    additionalValidation: {\r\n      idNumberPattern: /^\\d{3}-\\d{2}-\\d{4}$|^\\d{9}$/, // SSN format\r\n    },\r\n  },\r\n\r\n  // United Kingdom\r\n  GB: {\r\n    country: 'United Kingdom',\r\n    countryCode: 'GB',\r\n    idTypes: [\r\n      { value: 'PASSPORT', label: 'UK Passport', required: false },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's Licence\", required: false },\r\n      { value: 'NATIONAL_ID', label: 'National Identity Card', required: false },\r\n      { value: 'RESIDENCE_PERMIT', label: 'Biometric Residence Permit', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: true,\r\n      state: false, // UK uses counties, not required\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n  },\r\n\r\n  // Canada\r\n  CA: {\r\n    country: 'Canada',\r\n    countryCode: 'CA',\r\n    idTypes: [\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n      { value: 'PASSPORT', label: 'Canadian Passport', required: false },\r\n      { value: 'PROVINCIAL_ID', label: 'Provincial ID Card', required: false },\r\n      { value: 'HEALTH_CARD', label: 'Health Card', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: true,\r\n      state: true, // Provinces\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n    additionalValidation: {\r\n      idNumberPattern: /^[A-Z]\\d[A-Z]\\s?\\d[A-Z]\\d$/, // Postal code format\r\n    },\r\n  },\r\n\r\n  // Ghana\r\n  GH: {\r\n    country: 'Ghana',\r\n    countryCode: 'GH',\r\n    idTypes: [\r\n      { value: 'GHANA_CARD', label: 'Ghana Card (National ID)', required: true },\r\n      { value: 'VOTERS_ID', label: \"Voter's ID\", required: false },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n      { value: 'PASSPORT', label: 'Passport', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: false,\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n  },\r\n\r\n  // South Africa\r\n  ZA: {\r\n    country: 'South Africa',\r\n    countryCode: 'ZA',\r\n    idTypes: [\r\n      { value: 'ID_NUMBER', label: 'South African ID Number', required: true },\r\n      { value: 'PASSPORT', label: 'Passport', required: false },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: true,\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n    additionalValidation: {\r\n      idNumberLength: 13, // SA ID is 13 digits\r\n    },\r\n  },\r\n\r\n  // Kenya\r\n  KE: {\r\n    country: 'Kenya',\r\n    countryCode: 'KE',\r\n    idTypes: [\r\n      { value: 'NATIONAL_ID', label: 'National ID', required: true },\r\n      { value: 'PASSPORT', label: 'Passport', required: false },\r\n      { value: 'ALIEN_ID', label: 'Alien ID', required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: false,\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n  },\r\n\r\n  // Default for other countries\r\n  DEFAULT: {\r\n    country: 'Other',\r\n    countryCode: 'DEFAULT',\r\n    idTypes: [\r\n      { value: 'NATIONAL_ID', label: 'National ID', required: false },\r\n      { value: 'PASSPORT', label: 'Passport', required: false },\r\n      { value: 'DRIVERS_LICENSE', label: \"Driver's License\", required: false },\r\n    ],\r\n    requiredDocuments: {\r\n      idDocument: true,\r\n      proofOfAddress: true,\r\n      selfie: true,\r\n    },\r\n    addressFields: {\r\n      postalCode: true,\r\n      state: true,\r\n      city: true,\r\n    },\r\n    minAge: 18,\r\n  },\r\n};\r\n\r\nexport function getKycRequirements(countryCode: string): KycCountryRequirement {\r\n  return KYC_COUNTRY_REQUIREMENTS[countryCode] || KYC_COUNTRY_REQUIREMENTS.DEFAULT;\r\n}\r\n\r\nexport function validateIdNumber(\r\n  countryCode: string,\r\n  idType: string,\r\n  idNumber: string,\r\n): { valid: boolean; error?: string } {\r\n  const requirements = getKycRequirements(countryCode);\r\n\r\n  if (!requirements.additionalValidation) {\r\n    return { valid: true };\r\n  }\r\n\r\n  const { idNumberPattern, idNumberLength } = requirements.additionalValidation;\r\n\r\n  if (idNumberLength && idNumber.length !== idNumberLength) {\r\n    return {\r\n      valid: false,\r\n      error: `ID number must be ${idNumberLength} characters long`,\r\n    };\r\n  }\r\n\r\n  if (idNumberPattern && !idNumberPattern.test(idNumber)) {\r\n    return {\r\n      valid: false,\r\n      error: 'Invalid ID number format',\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\nexport function calculateAge(dateOfBirth: Date): number {\r\n  const today = new Date();\r\n  let age = today.getFullYear() - dateOfBirth.getFullYear();\r\n  const monthDiff = today.getMonth() - dateOfBirth.getMonth();\r\n\r\n  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dateOfBirth.getDate())) {\r\n    age--;\r\n  }\r\n\r\n  return age;\r\n}\r\n"],"names":["KYC_COUNTRY_REQUIREMENTS","calculateAge","getKycRequirements","validateIdNumber","NG","country","countryCode","idTypes","value","label","required","requiredDocuments","idDocument","proofOfAddress","selfie","addressFields","postalCode","state","city","minAge","additionalValidation","idNumberLength","US","idNumberPattern","GB","CA","GH","ZA","KE","DEFAULT","idType","idNumber","requirements","valid","length","error","test","dateOfBirth","today","Date","age","getFullYear","monthDiff","getMonth","getDate"],"mappings":"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"}
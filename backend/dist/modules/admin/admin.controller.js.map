{"version":3,"sources":["../../../src/modules/admin/admin.controller.ts"],"sourcesContent":["import { Controller, Get, Post, Patch, Body, Param, UseGuards } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger';\r\nimport { AdminService } from './admin.service';\r\nimport { JwtAuthGuard } from '../../common/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../../common/guards/roles.guard';\r\nimport { Roles } from '../../common/decorators/roles.decorator';\r\nimport { CurrentUser } from '../../common/decorators/current-user.decorator';\r\nimport { CreateUserDto, UpdateUserDto, UpdateBalanceDto, UpdateKycStatusDto, AdminUpdateTransferCodeDto } from './dto/create-user.dto';\r\nimport { TransferCodeType } from '@prisma/client';\r\nimport { TransferCodeTypeEnum } from './dto/transfer-code.dto';\r\n\r\n@ApiTags('admin')\r\n@Controller('admin')\r\n@UseGuards(JwtAuthGuard, RolesGuard)\r\n@Roles('BANK_ADMIN', 'SUPER_ADMIN')\r\n@ApiBearerAuth()\r\nexport class AdminController {\r\n  constructor(private readonly adminService: AdminService) {}\r\n\r\n  @Get('dashboard/stats')\r\n  @ApiOperation({ summary: 'Get admin dashboard statistics' })\r\n  getDashboardStats() {\r\n    return this.adminService.getDashboardStats();\r\n  }\r\n\r\n  @Get('dashboard/volume')\r\n  @ApiOperation({ summary: 'Get transaction volume data for last 7 days' })\r\n  getTransactionVolume() {\r\n    return this.adminService.getTransactionVolume();\r\n  }\r\n\r\n  @Get('dashboard/transaction-types')\r\n  @ApiOperation({ summary: 'Get transaction type distribution' })\r\n  getTransactionTypes() {\r\n    return this.adminService.getTransactionTypeDistribution();\r\n  }\r\n\r\n  @Get('dashboard/recent-activities')\r\n  @ApiOperation({ summary: 'Get recent system activities' })\r\n  getRecentActivities() {\r\n    return this.adminService.getRecentActivities();\r\n  }\r\n\r\n  @Get('dashboard/alerts')\r\n  @ApiOperation({ summary: 'Get system alerts' })\r\n  getSystemAlerts() {\r\n    return this.adminService.getSystemAlerts();\r\n  }\r\n\r\n  @Get('sidebar-counts')\r\n  @ApiOperation({ summary: 'Get pending counts for sidebar notifications' })\r\n  getSidebarCounts() {\r\n    return this.adminService.getSidebarCounts();\r\n  }\r\n\r\n  @Post('users/create')\r\n  @ApiOperation({ summary: 'Create a new user account' })\r\n  createUser(@Body() createUserDto: CreateUserDto, @CurrentUser() admin: any) {\r\n    return this.adminService.createUser(createUserDto, admin.id);\r\n  }\r\n\r\n  @Patch('users/:id')\r\n  @ApiOperation({ summary: 'Update user details' })\r\n  updateUser(\r\n    @Param('id') userId: string,\r\n    @Body() updateUserDto: UpdateUserDto,\r\n    @CurrentUser() admin: any,\r\n  ) {\r\n    return this.adminService.updateUser(userId, updateUserDto, admin.id);\r\n  }\r\n\r\n  @Patch('users/:id/balance')\r\n  @ApiOperation({ summary: 'Update user balance' })\r\n  updateBalance(\r\n    @Param('id') userId: string,\r\n    @Body() updateBalanceDto: UpdateBalanceDto,\r\n    @CurrentUser() admin: any,\r\n  ) {\r\n    return this.adminService.updateUserBalance(userId, updateBalanceDto, admin.id);\r\n  }\r\n\r\n  @Patch('users/:id/kyc')\r\n  @ApiOperation({ summary: 'Update KYC status' })\r\n  updateKyc(\r\n    @Param('id') userId: string,\r\n    @Body() updateKycDto: UpdateKycStatusDto,\r\n    @CurrentUser() admin: any,\r\n  ) {\r\n    return this.adminService.updateKycStatus(userId, updateKycDto, admin.id);\r\n  }\r\n\r\n  @Get('users/:id/transfer-codes')\r\n  @ApiOperation({ summary: 'Get user transfer codes' })\r\n  getTransferCodes(@Param('id') userId: string) {\r\n    return this.adminService.getTransferCodes(userId);\r\n  }\r\n\r\n  @Patch('users/:id/transfer-codes/:type')\r\n  @ApiOperation({ summary: 'Update transfer code (COT, IMF, TAX)' })\r\n  updateTransferCode(\r\n    @Param('id') userId: string,\r\n    @Param('type') codeType: string,\r\n    @Body() updateCodeDto: AdminUpdateTransferCodeDto,\r\n    @CurrentUser() admin: any,\r\n  ) {\r\n    return this.adminService.updateTransferCode(userId, codeType as TransferCodeType, updateCodeDto, admin.id);\r\n  }\r\n}\r\n"],"names":["AdminController","getDashboardStats","adminService","getTransactionVolume","getTransactionTypes","getTransactionTypeDistribution","getRecentActivities","getSystemAlerts","getSidebarCounts","createUser","createUserDto","admin","id","updateUser","userId","updateUserDto","updateBalance","updateBalanceDto","updateUserBalance","updateKyc","updateKycDto","updateKycStatus","getTransferCodes","updateTransferCode","codeType","updateCodeDto","summary"],"mappings":";;;;+BAgBaA;;;eAAAA;;;wBAhBwD;yBAChB;8BACxB;8BACA;4BACF;gCACL;sCACM;+BACmF;;;;;;;;;;;;;;;AASxG,IAAA,AAAMA,kBAAN,MAAMA;IAKXC,oBAAoB;QAClB,OAAO,IAAI,CAACC,YAAY,CAACD,iBAAiB;IAC5C;IAIAE,uBAAuB;QACrB,OAAO,IAAI,CAACD,YAAY,CAACC,oBAAoB;IAC/C;IAIAC,sBAAsB;QACpB,OAAO,IAAI,CAACF,YAAY,CAACG,8BAA8B;IACzD;IAIAC,sBAAsB;QACpB,OAAO,IAAI,CAACJ,YAAY,CAACI,mBAAmB;IAC9C;IAIAC,kBAAkB;QAChB,OAAO,IAAI,CAACL,YAAY,CAACK,eAAe;IAC1C;IAIAC,mBAAmB;QACjB,OAAO,IAAI,CAACN,YAAY,CAACM,gBAAgB;IAC3C;IAIAC,WAAW,AAAQC,aAA4B,EAAE,AAAeC,KAAU,EAAE;QAC1E,OAAO,IAAI,CAACT,YAAY,CAACO,UAAU,CAACC,eAAeC,MAAMC,EAAE;IAC7D;IAIAC,WACE,AAAaC,MAAc,EAC3B,AAAQC,aAA4B,EACpC,AAAeJ,KAAU,EACzB;QACA,OAAO,IAAI,CAACT,YAAY,CAACW,UAAU,CAACC,QAAQC,eAAeJ,MAAMC,EAAE;IACrE;IAIAI,cACE,AAAaF,MAAc,EAC3B,AAAQG,gBAAkC,EAC1C,AAAeN,KAAU,EACzB;QACA,OAAO,IAAI,CAACT,YAAY,CAACgB,iBAAiB,CAACJ,QAAQG,kBAAkBN,MAAMC,EAAE;IAC/E;IAIAO,UACE,AAAaL,MAAc,EAC3B,AAAQM,YAAgC,EACxC,AAAeT,KAAU,EACzB;QACA,OAAO,IAAI,CAACT,YAAY,CAACmB,eAAe,CAACP,QAAQM,cAAcT,MAAMC,EAAE;IACzE;IAIAU,iBAAiB,AAAaR,MAAc,EAAE;QAC5C,OAAO,IAAI,CAACZ,YAAY,CAACoB,gBAAgB,CAACR;IAC5C;IAIAS,mBACE,AAAaT,MAAc,EAC3B,AAAeU,QAAgB,EAC/B,AAAQC,aAAyC,EACjD,AAAed,KAAU,EACzB;QACA,OAAO,IAAI,CAACT,YAAY,CAACqB,kBAAkB,CAACT,QAAQU,UAA8BC,eAAed,MAAMC,EAAE;IAC3G;IAzFA,YAAY,AAAiBV,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;AA0F5D;;;;QAvFkBwB,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;;;;;QAUTA,SAAS;;;;;;;;;;;;;;;;QAUTA,SAAS;;;;;;;;;;;;;;;;QAUTA,SAAS;;;;;;;;;;;;QAMTA,SAAS"}
{"version":3,"sources":["../../../src/modules/audit/audit.controller.ts"],"sourcesContent":["import { Controller, Get, Query, UseGuards, Delete, Param, Body } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger';\r\nimport { AuditService } from './audit.service';\r\nimport { JwtAuthGuard } from '../../common/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../../common/guards/roles.guard';\r\nimport { Roles } from '../../common/decorators/roles.decorator';\r\n\r\n@ApiTags('audit')\r\n@Controller('audit')\r\n@UseGuards(JwtAuthGuard, RolesGuard)\r\n@ApiBearerAuth()\r\nexport class AuditController {\r\n  constructor(private readonly auditService: AuditService) {}\r\n\r\n  @Get('logs')\r\n  @Roles('SUPER_ADMIN')\r\n  @ApiOperation({ summary: 'Get all audit logs (Super Admin only)' })\r\n  getAllLogs(\r\n    @Query('action') action?: string,\r\n    @Query('entity') entity?: string,\r\n    @Query('actorRole') actorRole?: string,\r\n    @Query('limit') limit?: string,\r\n  ) {\r\n    return this.auditService.getAllLogs({\r\n      action,\r\n      entity,\r\n      actorRole,\r\n      limit: limit ? parseInt(limit) : 100,\r\n    });\r\n  }\r\n\r\n  @Get('stats')\r\n  @Roles('SUPER_ADMIN')\r\n  @ApiOperation({ summary: 'Get audit log statistics (Super Admin only)' })\r\n  getStats() {\r\n    return this.auditService.getStats();\r\n  }\r\n\r\n  @Delete('logs/:id')\r\n  @Roles('SUPER_ADMIN')\r\n  @ApiOperation({ summary: 'Delete audit log by ID (Super Admin only)' })\r\n  deleteLog(@Param('id') logId: string) {\r\n    return this.auditService.deleteAuditLog(logId);\r\n  }\r\n\r\n  @Delete('logs')\r\n  @Roles('SUPER_ADMIN')\r\n  @ApiOperation({ summary: 'Delete multiple audit logs (Super Admin only)' })\r\n  deleteLogs(@Body('ids') logIds: string[]) {\r\n    return this.auditService.deleteAuditLogs(logIds);\r\n  }\r\n}\r\n"],"names":["AuditController","getAllLogs","action","entity","actorRole","limit","auditService","parseInt","getStats","deleteLog","logId","deleteAuditLog","deleteLogs","logIds","deleteAuditLogs","summary"],"mappings":";;;;+BAWaA;;;eAAAA;;;wBAX0D;yBAClB;8BACxB;8BACA;4BACF;gCACL;;;;;;;;;;;;;;;AAMf,IAAA,AAAMA,kBAAN,MAAMA;IAMXC,WACE,AAAiBC,MAAe,EAChC,AAAiBC,MAAe,EAChC,AAAoBC,SAAkB,EACtC,AAAgBC,KAAc,EAC9B;QACA,OAAO,IAAI,CAACC,YAAY,CAACL,UAAU,CAAC;YAClCC;YACAC;YACAC;YACAC,OAAOA,QAAQE,SAASF,SAAS;QACnC;IACF;IAKAG,WAAW;QACT,OAAO,IAAI,CAACF,YAAY,CAACE,QAAQ;IACnC;IAKAC,UAAU,AAAaC,KAAa,EAAE;QACpC,OAAO,IAAI,CAACJ,YAAY,CAACK,cAAc,CAACD;IAC1C;IAKAE,WAAW,AAAaC,MAAgB,EAAE;QACxC,OAAO,IAAI,CAACP,YAAY,CAACQ,eAAe,CAACD;IAC3C;IAtCA,YAAY,AAAiBP,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;AAuC5D;;;;;QAnCkBS,SAAS;;;;;;;;;;;;;;;;;;;QAiBTA,SAAS;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;;QAOTA,SAAS"}
{"version":3,"sources":["../../../src/modules/investments/investments.service.ts"],"sourcesContent":["import { Injectable, BadRequestException, NotFoundException, Logger } from '@nestjs/common';\nimport { PrismaService } from '@/prisma/prisma.service';\nimport { Decimal } from '@prisma/client/runtime/library';\nimport { CreateInvestmentDto } from './dto/create-investment.dto';\n\n@Injectable()\nexport class InvestmentsService {\n  private readonly logger = new Logger(InvestmentsService.name);\n\n  // Investment plans with details\n  private readonly investmentPlans = {\n    BASIC: { name: 'Basic', minAmount: 1000, maxAmount: 50000, roi: 5, duration: 30 },\n    STANDARD: { name: 'Standard', minAmount: 50000, maxAmount: 500000, roi: 8, duration: 60 },\n    PREMIUM: { name: 'Premium', minAmount: 500000, maxAmount: 5000000, roi: 12, duration: 90 },\n    VIP: { name: 'VIP', minAmount: 5000000, maxAmount: null, roi: 15, duration: 120 },\n  };\n\n  constructor(private prisma: PrismaService) {}\n\n  /**\n   * Get available investment plans\n   */\n  getInvestmentPlans() {\n    return this.investmentPlans;\n  }\n\n  /**\n   * Create a new investment\n   */\n  async createInvestment(userId: string, data: CreateInvestmentDto) {\n    const user = await this.prisma.user.findUnique({\n      where: { id: userId },\n      include: { wallet: true },\n    });\n\n    if (!user) {\n      throw new NotFoundException('User not found');\n    }\n\n    // Validate plan\n    const plan = this.investmentPlans[data.planType];\n    if (!plan) {\n      throw new BadRequestException('Invalid investment plan');\n    }\n\n    const amount = new Decimal(data.amount);\n\n    // Validate amount\n    if (amount.lessThan(new Decimal(plan.minAmount))) {\n      throw new BadRequestException(`Minimum investment for ${plan.name} is ₦${plan.minAmount}`);\n    }\n    if (plan.maxAmount && amount.greaterThan(new Decimal(plan.maxAmount))) {\n      throw new BadRequestException(`Maximum investment for ${plan.name} is ₦${plan.maxAmount}`);\n    }\n\n    // Check wallet balance\n    if (user.wallet.balance.lessThan(amount)) {\n      throw new BadRequestException('Insufficient wallet balance');\n    }\n\n    // Calculate expected returns\n    const roiAmount = amount.mul(new Decimal(plan.roi)).div(100);\n    const totalReturn = amount.add(roiAmount);\n\n    // Create investment transaction\n    const result = await this.prisma.$transaction(async (tx) => {\n      // Debit wallet\n      const walletBefore = user.wallet.balance;\n      const walletAfter = walletBefore.sub(amount);\n\n      await tx.wallet.update({\n        where: { userId },\n        data: { balance: walletAfter },\n      });\n\n      // Create transaction record\n      await tx.transaction.create({\n        data: {\n          userId,\n          type: 'INVESTMENT',\n          status: 'COMPLETED',\n          amount,\n          balanceBefore: walletBefore,\n          balanceAfter: walletAfter,\n          description: `Investment in ${plan.name} plan`,\n          reference: `INV_${Date.now()}`,\n        },\n      });\n\n      // Calculate maturity date\n      const maturityDate = new Date();\n      maturityDate.setDate(maturityDate.getDate() + plan.duration);\n\n      // Create investment record\n      const investment = await tx.investment.create({\n        data: {\n          userId,\n          planType: data.planType,\n          amount,\n          roi: new Decimal(plan.roi),\n          expectedReturn: roiAmount,\n          duration: plan.duration,\n          maturityDate,\n          status: 'ACTIVE',\n        },\n      });\n\n      return investment;\n    });\n\n    return result;\n  }\n\n  /**\n   * Get user investments\n   */\n  async getUserInvestments(userId: string) {\n    return this.prisma.investment.findMany({\n      where: { userId },\n      orderBy: { createdAt: 'desc' },\n    });\n  }\n\n  /**\n   * Get investment details\n   */\n  async getInvestmentById(userId: string, investmentId: string) {\n    const investment = await this.prisma.investment.findUnique({\n      where: { id: investmentId },\n    });\n\n    if (!investment || investment.userId !== userId) {\n      throw new NotFoundException('Investment not found or unauthorized');\n    }\n\n    return investment;\n  }\n\n  /**\n   * Calculate current interest accrued\n   */\n  calculateAccruedInterest(investment: any): number {\n    if (investment.status !== 'ACTIVE') {\n      return 0;\n    }\n\n    const now = new Date();\n    const startDate = new Date(investment.startDate);\n    const maturityDate = new Date(investment.maturityDate);\n\n    const totalDays = (maturityDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24);\n    const elapsedDays = (now.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24);\n\n    if (elapsedDays <= 0) return 0;\n    if (elapsedDays >= totalDays) return investment.expectedReturn.toNumber();\n\n    return (\n      (investment.expectedReturn.toNumber() * elapsedDays) / totalDays\n    );\n  }\n\n  /**\n   * Get investment summary\n   */\n  async getInvestmentSummary(userId: string) {\n    const investments = await this.getUserInvestments(userId);\n\n    const summary = {\n      totalInvested: new Decimal(0),\n      activeInvestments: 0,\n      completedInvestments: 0,\n      totalExpectedReturn: new Decimal(0),\n      accruedInterest: 0,\n      investments: [],\n    };\n\n    investments.forEach((inv) => {\n      summary.totalInvested = summary.totalInvested.add(inv.amount);\n      summary.totalExpectedReturn = summary.totalExpectedReturn.add(inv.expectedReturn);\n\n      if (inv.status === 'ACTIVE') {\n        summary.activeInvestments++;\n        summary.accruedInterest += this.calculateAccruedInterest(inv);\n      } else if (inv.status === 'MATURED') {\n        summary.completedInvestments++;\n      }\n\n      summary.investments.push({\n        ...inv,\n        accruedInterest: this.calculateAccruedInterest(inv),\n        daysRemaining: Math.max(\n          0,\n          Math.ceil(\n            (new Date(inv.maturityDate).getTime() - new Date().getTime()) /\n            (1000 * 60 * 60 * 24)\n          )\n        ),\n      });\n    });\n\n    return summary;\n  }\n\n  /**\n   * Process matured investments (called by cron job)\n   */\n  async processMatureInvestments() {\n    const now = new Date();\n\n    const matureInvestments = await this.prisma.investment.findMany({\n      where: {\n        status: 'ACTIVE',\n        maturityDate: {\n          lte: now,\n        },\n      },\n      include: { user: { include: { wallet: true } } },\n    });\n\n    this.logger.log(`Processing ${matureInvestments.length} mature investments`);\n\n    for (const investment of matureInvestments) {\n      await this.prisma.$transaction(async (tx) => {\n        // Credit wallet with total return\n        const walletBefore = investment.user.wallet.balance;\n        const walletAfter = walletBefore.add(investment.expectedReturn);\n\n        await tx.wallet.update({\n          where: { userId: investment.userId },\n          data: { balance: walletAfter },\n        });\n\n        // Create transaction record\n        await tx.transaction.create({\n          data: {\n            userId: investment.userId,\n            type: 'INVESTMENT_MATURITY',\n            status: 'COMPLETED',\n            amount: investment.amount.add(investment.expectedReturn),\n            balanceBefore: walletBefore,\n            balanceAfter: walletAfter,\n            description: `Investment maturity credit - Total return ₦${investment.amount.add(investment.expectedReturn)}`,\n            reference: investment.id,\n          },\n        });\n\n        // Mark investment as completed\n        await tx.investment.update({\n          where: { id: investment.id },\n          data: { status: 'MATURED' },\n        });\n      });\n    }\n\n    return matureInvestments.length;\n  }\n\n  /**\n   * Liquidate investment early (with penalty)\n   */\n  async liquidateInvestment(userId: string, investmentId: string) {\n    const investment = await this.prisma.investment.findUnique({\n      where: { id: investmentId },\n      include: { user: { include: { wallet: true } } },\n    });\n\n    if (!investment || investment.userId !== userId) {\n      throw new NotFoundException('Investment not found or unauthorized');\n    }\n\n    if (investment.status !== 'ACTIVE') {\n      throw new BadRequestException('Only active investments can be liquidated');\n    }\n\n    // Calculate penalty (10% of expected return)\n    const penalty = investment.expectedReturn.mul(0.1);\n    const returnAmount = investment.amount.add(investment.expectedReturn).sub(penalty);\n\n    const result = await this.prisma.$transaction(async (tx) => {\n      // Credit wallet\n      const walletBefore = investment.user.wallet.balance;\n      const walletAfter = walletBefore.add(returnAmount);\n\n      await tx.wallet.update({\n        where: { userId: investment.userId },\n        data: { balance: walletAfter },\n      });\n\n      // Create transaction record\n      await tx.transaction.create({\n        data: {\n          userId: investment.userId,\n          type: 'INVESTMENT_LIQUIDATION',\n          status: 'COMPLETED',\n          amount: returnAmount,\n          balanceBefore: walletBefore,\n          balanceAfter: walletAfter,\n          description: `Early liquidation (Penalty: Ã¢â€šÂ¦${penalty})`,\n          reference: investment.id,\n        },\n      });\n\n      // Mark investment as liquidated\n      return tx.investment.update({\n        where: { id: investment.id },\n        data: { status: 'LIQUIDATED' },\n      });\n    });\n\n    return result;\n  }\n}\n"],"names":["InvestmentsService","getInvestmentPlans","investmentPlans","createInvestment","userId","data","user","prisma","findUnique","where","id","include","wallet","NotFoundException","plan","planType","BadRequestException","amount","Decimal","lessThan","minAmount","name","maxAmount","greaterThan","balance","roiAmount","mul","roi","div","totalReturn","add","result","$transaction","tx","walletBefore","walletAfter","sub","update","transaction","create","type","status","balanceBefore","balanceAfter","description","reference","Date","now","maturityDate","setDate","getDate","duration","investment","expectedReturn","getUserInvestments","findMany","orderBy","createdAt","getInvestmentById","investmentId","calculateAccruedInterest","startDate","totalDays","getTime","elapsedDays","toNumber","getInvestmentSummary","investments","summary","totalInvested","activeInvestments","completedInvestments","totalExpectedReturn","accruedInterest","forEach","inv","push","daysRemaining","Math","max","ceil","processMatureInvestments","matureInvestments","lte","logger","log","length","liquidateInvestment","penalty","returnAmount","Logger","BASIC","STANDARD","PREMIUM","VIP"],"mappings":"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"}
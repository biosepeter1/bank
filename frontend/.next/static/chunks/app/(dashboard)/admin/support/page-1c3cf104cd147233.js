(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6194],{16554:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>R});var t=a(95155),r=a(12115),l=a(8751),n=a(83209),i=a(97003),o=a(33789),c=a(90235),d=a(67001),m=a(90923),u=a(47507),x=a(54679),h=a(6132),g=a(26983),p=a(61362),b=a(82063),j=a(14755),f=a(20508),y=a(23664),N=a(45345),w=a(16485),v=a(37586),A=a(71360),k=a(18085),C=a(65229),S=a(22663),E=a(60125),I=a(40285),T=a(90104),F=a(14324),B=a(9829),L=a(95704);function R(){var e;let{branding:s}=(0,F.Z)(),{user:a}=(0,I.n)(),{socket:R}=(0,T.F)(null==a?void 0:a.id,null==a?void 0:a.role),[U,D]=(0,r.useState)([]),[P,O]=(0,r.useState)(!0),[M,V]=(0,r.useState)(""),[G,z]=(0,r.useState)(null),[_,Z]=(0,r.useState)(!1),[W,$]=(0,r.useState)(!1),[K,J]=(0,r.useState)({status:"",resolution:""}),[H,Y]=(0,r.useState)(""),[q,Q]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[es,ea]=(0,r.useState)(!1),[et,er]=(0,r.useState)({subject:"",message:""}),[el,en]=(0,r.useState)(!1),[ei,eo]=(0,r.useState)("tickets"),[ec,ed]=(0,r.useState)(null),[em,eu]=(0,r.useState)([]),[ex,eh]=(0,r.useState)(null),[eg,ep]=(0,r.useState)(""),eb=(0,r.useRef)(null),ej=e=>{let s=e.match(/\[GUEST CONTACT\]\s*Name:\s*(.+?)\s*Email:\s*(.+?)\s*---\s*([\s\S]*)/i);return s?{name:s[1].trim(),email:s[2].trim(),cleanMessage:s[3].trim()}:null};(0,r.useEffect)(()=>{ey()},[M]),(0,r.useEffect)(()=>{if(R)return R.on("newMessage",e=>{G&&e.ticketId===G.id&&z(s=>s?{...s,messages:[...s.messages||[],e]}:s),"USER"===e.senderType&&S.Ay.success("New message from user")}),()=>{R.off("newMessage")}},[R,G]),(0,r.useEffect)(()=>{if("live-chat"!==ei||ec)"live-chat"!==ei&&ec&&(ec.disconnect(),ed(null));else{let e=L.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:3001",s=(0,B.io)("".concat(e,"/live-chat"),{transports:["websocket","polling"]});return s.on("connect",()=>{console.log("Admin connected to Live Chat"),s.emit("joinAdminRoom")}),s.on("disconnect",()=>{console.log("Admin disconnected from Live Chat"),S.Ay.error("Live Chat disconnected. Please refresh.")}),s.on("newChatSession",e=>{S.Ay.success("New Live Chat Request!"),eu(s=>[e,...s])}),s.on("newMessage",e=>{if(eu(s=>s.map(s=>s.id===e.sessionId?{...s,messages:[...s.messages,e],updatedAt:new Date().toISOString()}:s)),eh(s=>s&&s.id===e.sessionId?{...s,messages:[...s.messages,e]}:s),ex&&ex.id===e.sessionId){var s;null==(s=eb.current)||s.scrollIntoView({behavior:"smooth"})}else"ADMIN"!==e.sender&&(0,S.Ay)("New message in session ".concat(e.sessionId.slice(0,8)))}),s.on("sessionEnded",e=>{(0,S.Ay)("Chat session ".concat(e.slice(0,8)," ended.")),eu(s=>s.filter(s=>s.id!==e)),(null==ex?void 0:ex.id)===e&&eh(null)}),ed(s),ef(),()=>{s.disconnect(),ed(null)}}},[ei,a]),(0,r.useEffect)(()=>{var e;null==(e=eb.current)||e.scrollIntoView({behavior:"smooth"})},[null==ex?void 0:ex.messages]);let ef=async()=>{try{let e=await E.A.get("/live-chat/admin/sessions");eu(e.data)}catch(e){console.error("Failed to fetch live chat sessions:",e),S.Ay.error("Failed to load live chat sessions")}},ey=async()=>{try{O(!0);let e=await E.A.get("/support/admin/tickets",{params:M?{status:M}:{}});D(e.data)}catch(a){var e,s;console.error("Failed to fetch tickets:",a),S.Ay.error((null==a||null==(s=a.response)||null==(e=s.data)?void 0:e.message)||"Failed to load tickets")}finally{O(!1)}},eN=async()=>{if(G)try{Q(!0),await E.A.patch("/support/admin/tickets/".concat(G.id),{status:K.status||G.status,resolution:K.resolution||void 0}),S.Ay.success("Ticket updated successfully"),Z(!1),z(null),J({status:"",resolution:""}),ey()}catch(a){var e,s;console.error("Failed to update ticket:",a),S.Ay.error((null==a||null==(s=a.response)||null==(e=s.data)?void 0:e.message)||"Failed to update ticket")}finally{Q(!1)}},ew=async e=>{if(confirm("Are you sure you want to delete this ticket?"))try{await E.A.delete("/support/admin/tickets/".concat(e)),S.Ay.success("Ticket deleted successfully"),ey()}catch(e){var s,a;console.error("Failed to delete ticket:",e),S.Ay.error((null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.message)||"Failed to delete ticket")}},ev=async e=>{try{let s=await E.A.get("/support/admin/tickets/".concat(e.id));z(s.data)}catch(s){console.error("Failed to fetch latest ticket:",s),z(e)}$(!0)},eA=async()=>{if(G&&H.trim())try{ee(!0);let e=(await E.A.post("/support/admin/tickets/".concat(G.id,"/reply"),{message:H.trim()})).data;S.Ay.success("Message sent"),Y(""),G&&z({...G,messages:[...G.messages||[],e]})}catch(a){var e,s;console.error("Failed to send reply:",a),S.Ay.error((null==a||null==(s=a.response)||null==(e=s.data)?void 0:e.message)||"Failed to send reply")}finally{ee(!1)}},ek=async()=>{if(!G||!et.message.trim())return;let e=ej(G.message);if(!e)return void S.Ay.error("Could not find guest email address");try{en(!0),await E.A.post("/support/admin/tickets/".concat(G.id,"/email-reply"),{guestEmail:e.email,guestName:e.name,subject:et.subject,message:et.message}),S.Ay.success("Email sent successfully to ".concat(e.email)),ea(!1),er({subject:"",message:""}),ey()}catch(e){var s,a;console.error("Failed to send email:",e),S.Ay.error((null==e||null==(a=e.response)||null==(s=a.data)?void 0:s.message)||"Failed to send email")}finally{en(!1)}};return(0,t.jsxs)("div",{className:"p-6 space-y-6 h-[calc(100vh-80px)] overflow-hidden flex flex-col",children:[(0,t.jsx)("div",{className:"flex items-center justify-between flex-shrink-0",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Support Center"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage tickets and live support"})]})}),(0,t.jsxs)(m.tU,{value:ei,onValueChange:eo,className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)("div",{className:"flex items-center justify-between border-b px-1",children:(0,t.jsxs)(m.j7,{className:"bg-transparent border-b-0 -mb-px",children:[(0,t.jsxs)(m.Xi,{value:"tickets",className:"data-[state=active]:border-b-2 data-[state=active]:border-blue-600 rounded-none px-6",children:[(0,t.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Tickets"]}),(0,t.jsxs)(m.Xi,{value:"live-chat",className:"data-[state=active]:border-b-2 data-[state=active]:border-green-600 rounded-none px-6",children:[(0,t.jsx)(j.A,{className:"w-4 h-4 mr-2"}),"Live Chat",em.filter(e=>"QUEUED"===e.status).length>0&&(0,t.jsx)("span",{className:"ml-2 px-2 py-0.5 rounded-full bg-red-500 text-white text-xs font-bold animate-pulse",children:em.filter(e=>"QUEUED"===e.status).length})]})]})}),(0,t.jsx)(m.av,{value:"tickets",className:"flex-1 overflow-y-auto pt-4",children:(0,t.jsxs)("div",{className:"space-y-6 pb-20",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Ticket Queue"}),(0,t.jsxs)(u.l6,{value:M||"all",onValueChange:e=>V("all"===e?"":e),children:[(0,t.jsx)(u.bq,{className:"w-48",children:(0,t.jsx)(u.yv,{placeholder:"Filter by status"})}),(0,t.jsxs)(u.gC,{children:[(0,t.jsx)(u.eb,{value:"all",children:"All Tickets"}),(0,t.jsx)(u.eb,{value:"OPEN",children:"Open"}),(0,t.jsx)(u.eb,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(u.eb,{value:"RESOLVED",children:"Resolved"}),(0,t.jsx)(u.eb,{value:"CLOSED",children:"Closed"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Open"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:U.filter(e=>"OPEN"===e.status).length})]}),(0,t.jsx)(h.A,{className:"w-8 h-8 text-blue-600"})]})})}),(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"In Progress"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:U.filter(e=>"IN_PROGRESS"===e.status).length})]}),(0,t.jsx)(g.A,{className:"w-8 h-8 text-yellow-600"})]})})}),(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Resolved"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:U.filter(e=>"RESOLVED"===e.status).length})]}),(0,t.jsx)(p.A,{className:"w-8 h-8 text-green-600"})]})})}),(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:U.length})]}),(0,t.jsx)(b.A,{className:"w-8 h-8 text-gray-600"})]})})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"All Support Tickets"}),(0,t.jsx)(n.BT,{children:"View and manage user support requests"})]}),(0,t.jsx)(n.Wu,{children:P?(0,t.jsx)("div",{className:"py-12 text-center text-gray-600",children:"Loading tickets..."}):0===U.length?(0,t.jsxs)("div",{className:"py-12 text-center",children:[(0,t.jsx)(b.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"No support tickets found"})]}):(0,t.jsx)("div",{className:"space-y-4",children:U.map(e=>{var s;let a="guest@contact.system"===e.user.email?ej(e.message):null;return(0,t.jsxs)("div",{className:"p-4 border-2 rounded-lg ".concat((e=>{switch(e){case"OPEN":return"bg-blue-50 text-blue-700 border-blue-200";case"IN_PROGRESS":return"bg-yellow-50 text-yellow-700 border-yellow-200";case"RESOLVED":return"bg-green-50 text-green-700 border-green-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}})(e.status)),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg",children:e.subject}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"URGENT":return"text-red-700 bg-red-100 border-red-300";case"HIGH":return"text-orange-700 bg-orange-100 border-orange-300";case"MEDIUM":return"text-yellow-700 bg-yellow-100 border-yellow-300";case"LOW":return"text-green-700 bg-green-100 border-green-300";default:return"text-gray-700 bg-gray-100 border-gray-300"}})(e.priority)),children:e.priority}),a&&(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700 border border-purple-300",children:"GUEST"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:a?a.name:"".concat(e.user.firstName," ").concat(e.user.lastName)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(y.A,{className:"w-4 h-4"}),a?(0,t.jsx)("span",{className:"text-purple-700 font-medium",children:a.email}):(0,t.jsx)("span",{children:e.user.email})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(N.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:e.category})]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-700 mb-2",children:[(0,t.jsx)("strong",{children:"Message:"})," ",a?a.cleanMessage:e.message]}),e.resolution&&(0,t.jsxs)("p",{className:"text-sm text-green-700 bg-green-50 p-2 rounded",children:[(0,t.jsx)("strong",{children:"Resolution:"})," ",e.resolution]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[(0,t.jsx)(w.A,{className:"w-3 h-3 inline mr-1"}),"Created: ",new Date(e.createdAt).toLocaleString()," • Updated:"," ",new Date(e.updatedAt).toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(e=>{switch(e){case"OPEN":return(0,t.jsx)(h.A,{className:"w-4 h-4 text-blue-600"});case"IN_PROGRESS":return(0,t.jsx)(g.A,{className:"w-4 h-4 text-yellow-600"});case"RESOLVED":return(0,t.jsx)(p.A,{className:"w-4 h-4 text-green-600"});case"CLOSED":return(0,t.jsx)(p.A,{className:"w-4 h-4 text-gray-600"});default:return null}})(e.status),(0,t.jsx)("span",{className:"text-xs font-medium",children:e.status.replace("_"," ")})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[a&&(0,t.jsxs)(i.$,{size:"sm",onClick:()=>{z(e),ej(e.message),er({subject:"Re: ".concat(e.subject),message:""}),ea(!0)},className:"bg-purple-600 hover:bg-purple-700",children:[(0,t.jsx)(y.A,{className:"w-4 h-4 mr-1"}),"Reply via Email"]}),(0,t.jsxs)(i.$,{size:"sm",onClick:()=>ev(e),className:"bg-green-600 hover:bg-green-700",children:[(0,t.jsx)(v.A,{className:"w-4 h-4 mr-1"}),"View Chat (",(null==(s=e.messages)?void 0:s.length)||0,")"]}),(0,t.jsx)(i.$,{size:"sm",onClick:()=>{z(e),J({status:e.status,resolution:e.resolution||""}),Z(!0)},className:"bg-blue-600 hover:bg-blue-700",children:"Update Status"}),(0,t.jsxs)(i.$,{size:"sm",variant:"destructive",onClick:()=>ew(e.id),children:[(0,t.jsx)(A.A,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},e.id)})})})]})]})}),(0,t.jsxs)(m.av,{value:"live-chat",className:"flex-1 flex overflow-hidden pt-4 gap-4 h-full",children:[(0,t.jsxs)(n.Zp,{className:"w-80 flex flex-col h-full border-r rounded-r-none",children:[(0,t.jsx)(n.aR,{className:"p-4 border-b",children:(0,t.jsx)(n.ZB,{className:"text-lg",children:"Live Sessions"})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===em.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500 text-sm",children:"No active sessions"}):em.sort((e,s)=>s.updatedAt.localeCompare(e.updatedAt)).map(e=>{var s;return(0,t.jsxs)("div",{onClick:()=>eh(e),className:"p-4 border-b cursor-pointer hover:bg-slate-50 transition-colors ".concat((null==ex?void 0:ex.id)===e.id?"bg-slate-100 border-l-4 border-l-blue-500":""),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsx)("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full ".concat("QUEUED"===e.status?"bg-yellow-100 text-yellow-700":"ACTIVE"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),children:e.status}),(0,t.jsx)("span",{className:"text-[10px] text-gray-400",children:new Date(e.updatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("h4",{className:"font-medium text-sm truncate",children:e.user?"".concat(e.user.firstName," ").concat(e.user.lastName):"Guest (".concat(e.userIp,")")}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate mt-1",children:(null==(s=e.messages[e.messages.length-1])?void 0:s.message)||"No messages yet"})]},e.id)})})]}),(0,t.jsx)(n.Zp,{className:"flex-1 flex flex-col h-full rounded-l-none border-l-0 shadow-none",children:ex?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.aR,{className:"p-4 border-b flex flex-row items-center justify-between bg-slate-50/50",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.ZB,{className:"text-lg flex items-center gap-2",children:[ex.user?"".concat(ex.user.firstName," ").concat(ex.user.lastName):"Guest (".concat(ex.userIp,")"),"ACTIVE"===ex.status&&(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})]}),(0,t.jsxs)(n.BT,{children:["ID: ",ex.id.slice(0,8)," • ",ex.status]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["QUEUED"===ex.status&&(0,t.jsx)(i.$,{onClick:()=>(e=>{var s;if(!ec||!a)return;ec.emit("adminJoinSession",{sessionId:e.id,adminId:a.id});let t={...e,status:"ACTIVE",admin:{firstName:a.firstName,lastName:a.lastName}};eu(s=>s.map(s=>s.id===e.id?t:s)),eh(t),S.Ay.success("Joined chat session with ".concat((null==(s=e.user)?void 0:s.firstName)||"Guest"))})(ex),className:"bg-green-600 hover:bg-green-700 text-white",children:"Accept Chat"}),"ACTIVE"===ex.status&&(0,t.jsx)(i.$,{onClick:()=>{var e;return e=ex,void(ec&&a&&confirm("Are you sure you want to end this chat session?")&&(ec.emit("adminEndSession",{sessionId:e.id,adminId:a.id}),S.Ay.success("Chat session ended."),eu(s=>s.filter(s=>s.id!==e.id)),(null==ex?void 0:ex.id)===e.id&&eh(null)))},variant:"destructive",children:"End Chat"})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50/30",children:[ex.messages.map(e=>(0,t.jsx)("div",{className:"flex ".concat("ADMIN"===e.sender?"justify-end":"justify-start"),children:(0,t.jsx)("div",{className:"max-w-[70%] rounded-xl px-4 py-2 text-sm shadow-sm ".concat("ADMIN"===e.sender?"bg-blue-600 text-white rounded-br-none":"SYSTEM"===e.sender?"bg-gray-200 text-gray-600 text-xs italic text-center w-full bg-transparent shadow-none":"bg-white border rounded-bl-none"),children:e.message})},e.id)),(0,t.jsx)("div",{ref:eb})]}),(0,t.jsx)("div",{className:"p-4 border-t bg-white",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),ec&&ex&&eg.trim()&&(ec.emit("sendMessage",{sessionId:ex.id,message:eg,sender:"ADMIN"}),ep(""))},className:"flex gap-2",children:[(0,t.jsx)(o.p,{value:eg,onChange:e=>ep(e.target.value),placeholder:"Type a message...",disabled:"ACTIVE"!==ex.status}),(0,t.jsx)(i.$,{type:"submit",disabled:"ACTIVE"!==ex.status||!eg.trim(),children:(0,t.jsx)(k.A,{className:"w-4 h-4"})})]})})]}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[(0,t.jsx)(j.A,{className:"w-16 h-16 mb-4 opacity-20"}),(0,t.jsx)("p",{children:"Select a session to start chatting"})]})})]})]}),(0,t.jsx)(x.lG,{open:_,onOpenChange:Z,children:(0,t.jsxs)(x.Cf,{children:[(0,t.jsxs)(x.c7,{children:[(0,t.jsx)(x.L3,{children:"Update Support Ticket"}),(0,t.jsx)(x.rr,{children:"Update the status and add resolution notes for this ticket"})]}),G&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"Ticket:"})," ",G.subject]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"User:"})," ",G.user.firstName," ",G.user.lastName," (",G.user.email,")"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.J,{htmlFor:"status",children:"Status"}),(0,t.jsxs)(u.l6,{value:K.status,onValueChange:e=>J({...K,status:e}),children:[(0,t.jsx)(u.bq,{children:(0,t.jsx)(u.yv,{placeholder:"Select status"})}),(0,t.jsxs)(u.gC,{children:[(0,t.jsx)(u.eb,{value:"OPEN",children:"Open"}),(0,t.jsx)(u.eb,{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)(u.eb,{value:"RESOLVED",children:"Resolved"}),(0,t.jsx)(u.eb,{value:"CLOSED",children:"Closed"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.J,{htmlFor:"resolution",children:"Resolution Notes (Optional)"}),(0,t.jsx)(d.T,{id:"resolution",placeholder:"Add resolution notes...",rows:4,value:K.resolution,onChange:e=>J({...K,resolution:e.target.value})})]})]}),(0,t.jsxs)(x.Es,{children:[(0,t.jsx)(i.$,{variant:"outline",onClick:()=>Z(!1),disabled:q,children:"Cancel"}),(0,t.jsx)(i.$,{onClick:eN,disabled:q,children:q?"Updating...":"Update Ticket"})]})]})}),W&&G&&(0,t.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(l.P.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white rounded-2xl max-w-3xl w-full max-h-[85vh] flex flex-col shadow-2xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-6 text-white relative overflow-hidden",style:{background:"linear-gradient(135deg, ".concat(s.colors.primary," 0%, ").concat(s.colors.secondary," 100%)")},children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,t.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl"})}),(0,t.jsxs)("div",{className:"relative z-10 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[s.logo?(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm p-2 flex items-center justify-center shadow-lg",children:(0,t.jsx)("img",{src:s.logo,alt:"Bank Logo",className:"w-full h-full object-contain"})}):(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg",children:(0,t.jsx)(v.A,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-xl",children:G.subject}),(0,t.jsxs)("p",{className:"text-sm text-white/80 flex items-center gap-2",children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),G.user.firstName," ",G.user.lastName,(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs",children:G.category})]})]})]}),(0,t.jsx)("button",{onClick:()=>$(!1),className:"p-2 hover:bg-white/20 rounded-full transition-all",children:(0,t.jsx)(C.A,{className:"w-6 h-6"})})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-b from-gray-50 to-white",children:[(0,t.jsxs)(l.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:[(0,t.jsxs)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0 shadow-md",style:{background:s.colors.primary},children:[G.user.firstName.charAt(0),G.user.lastName.charAt(0)]}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl rounded-tl-sm p-4 shadow-md border-2",style:{borderColor:"".concat(s.colors.primary,"20")},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsxs)("span",{className:"font-bold text-sm",style:{color:s.colors.primary},children:[G.user.firstName," ",G.user.lastName]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:new Date(G.createdAt).toLocaleString()})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:G.message})]})})]}),null==(e=G.messages)?void 0:e.map((e,a)=>(0,t.jsxs)(l.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"flex gap-3 ".concat("ADMIN"===e.senderType?"flex-row-reverse":""),children:["USER"===e.senderType?(0,t.jsxs)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0 shadow-md",style:{background:s.colors.primary},children:[G.user.firstName.charAt(0),G.user.lastName.charAt(0)]}):(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center flex-shrink-0 shadow-md border-2",style:{borderColor:s.colors.secondary},children:s.logo?(0,t.jsx)("img",{src:s.logo,alt:"Admin",className:"w-6 h-6 object-contain"}):(0,t.jsx)(v.A,{className:"w-5 h-5",style:{color:s.colors.secondary}})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"rounded-2xl p-4 shadow-md ".concat("USER"===e.senderType?"rounded-tl-sm bg-white border-2":"rounded-tr-sm border-2"),style:{borderColor:"USER"===e.senderType?"".concat(s.colors.primary,"20"):"".concat(s.colors.secondary,"20"),background:"USER"===e.senderType?"white":"".concat(s.colors.secondary,"08")},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"font-bold text-sm",style:{color:"USER"===e.senderType?s.colors.primary:s.colors.secondary},children:"USER"===e.senderType?"".concat(G.user.firstName," ").concat(G.user.lastName):"Support Team (You)"}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleString()})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.message})]})})]},e.id))]}),(0,t.jsx)("div",{className:"p-6 border-t bg-white",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(d.T,{placeholder:"Type your response to the user...",value:H,onChange:e=>Y(e.target.value),rows:3,className:"resize-none border-2 rounded-xl focus:ring-2 pr-12 transition-all",style:{borderColor:"".concat(s.colors.primary,"30"),"--tw-ring-color":s.colors.primary}})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.$,{onClick:eA,disabled:X||!H.trim(),className:"flex-1 text-white font-semibold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]",style:{background:"linear-gradient(135deg, ".concat(s.colors.primary," 0%, ").concat(s.colors.secondary," 100%)")},children:X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.A,{className:"w-4 h-4 mr-2"}),"Send Response"]})}),(0,t.jsxs)(i.$,{variant:"outline",onClick:()=>$(!1),className:"border-2 font-semibold hover:scale-[1.02] transition-all",style:{borderColor:s.colors.primary,color:s.colors.primary},children:[(0,t.jsx)(C.A,{className:"w-4 h-4 mr-2"}),"Close"]})]})]})})]})}),(0,t.jsx)(x.lG,{open:es,onOpenChange:ea,children:(0,t.jsxs)(x.Cf,{className:"max-w-lg",children:[(0,t.jsxs)(x.c7,{children:[(0,t.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,t.jsx)(y.A,{className:"w-5 h-5 text-purple-600"}),"Reply via Email"]}),(0,t.jsx)(x.rr,{children:"Send an email response to the guest contact"})]}),G&&(()=>{let e=ej(G.message);return e?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("strong",{children:"To:"})," ",e.name," (",e.email,")"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[(0,t.jsx)("strong",{children:"Reference:"})," #",G.id.substring(0,8).toUpperCase()]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.J,{htmlFor:"email-subject",children:"Subject"}),(0,t.jsx)(o.p,{id:"email-subject",value:et.subject,onChange:e=>er({...et,subject:e.target.value}),placeholder:"Email subject"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.J,{htmlFor:"email-message",children:"Message"}),(0,t.jsx)(d.T,{id:"email-message",value:et.message,onChange:e=>er({...et,message:e.target.value}),placeholder:"Type your response here...",rows:6})]})]}):null})(),(0,t.jsxs)(x.Es,{children:[(0,t.jsx)(i.$,{variant:"outline",onClick:()=>ea(!1),children:"Cancel"}),(0,t.jsx)(i.$,{onClick:ek,disabled:el||!et.message.trim(),className:"bg-purple-600 hover:bg-purple-700",children:el?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.A,{className:"w-4 h-4 mr-2"}),"Send Email"]})})]})]})})]})}},38918:(e,s,a)=>{"use strict";a.d(s,{MH:()=>l,dD:()=>t,z7:()=>r});let t={"011":{name:"First Bank of Nigeria",code:"011",shortName:"FirstBank",email:"support@firstbank.ng",phone:"+234 800 000 0000",website:"www.firstbanknigeria.com",address:"Samuel Asabia House, 35 Marina",city:"Lagos Island, Lagos",colors:{primary:"#00416A",secondary:"#FFB81C",rgb:[0,65,106]},tagline:"Truly the First",watermark:"FIRST BANK"},"033":{name:"United Bank for Africa",code:"033",shortName:"UBA",email:"contactcentre@ubagroup.com",phone:"+234 700 225 5822",website:"www.ubagroup.com",address:"UBA House, 57 Marina",city:"Lagos Island, Lagos",colors:{primary:"#D4002A",secondary:"#000000",rgb:[212,0,42]},tagline:"Africa's Global Bank",watermark:"UBA"},"057":{name:"Zenith Bank",code:"057",shortName:"Zenith",email:"customercare@zenithbank.com",phone:"+234 1 278 7000",website:"www.zenithbank.com",address:"Plot 84, Ajose Adeogun Street",city:"Victoria Island, Lagos",colors:{primary:"#EB1C24",secondary:"#000000",rgb:[235,28,36]},tagline:"Your Bank, Our Pride",watermark:"ZENITH BANK"},"058":{name:"Guaranty Trust Bank",code:"058",shortName:"GTBank",email:"gti@gtbank.com",phone:"+234 1 448 0000",website:"www.gtbank.com",address:"Plot 635, Akin Adesola Street",city:"Victoria Island, Lagos",colors:{primary:"#FF6600",secondary:"#000000",rgb:[255,102,0]},tagline:"Africa's Leading Financial Institution",watermark:"GTBANK"},"044":{name:"Access Bank",code:"044",shortName:"Access",email:"contactcenter@accessbankplc.com",phone:"+234 1 271 2005",website:"www.accessbankplc.com",address:"Plot 1665, Oyin Jolayemi Street",city:"Victoria Island, Lagos",colors:{primary:"#F37920",secondary:"#000000",rgb:[243,121,32]},tagline:"Your Partner in Progress",watermark:"ACCESS BANK"},"035":{name:"Wema Bank",code:"035",shortName:"Wema",email:"customercare@wemabank.com",phone:"+234 1 277 5050",website:"www.wemabank.com",address:"54 Marina",city:"Lagos Island, Lagos",colors:{primary:"#800080",secondary:"#FFD700",rgb:[128,0,128]},tagline:"We are Wema",watermark:"WEMA BANK"},"070":{name:"Fidelity Bank",code:"070",shortName:"Fidelity",email:"customerservice@fidelitybank.ng",phone:"+234 1 448 5500",website:"www.fidelitybank.ng",address:"2 Kofo Abayomi Street",city:"Victoria Island, Lagos",colors:{primary:"#D4AF37",secondary:"#1A1A1A",rgb:[212,175,55]},tagline:"Fidelity Bank - Your Trusted Partner",watermark:"FIDELITY BANK"},232:{name:"Sterling Bank",code:"232",shortName:"Sterling",email:"contactcentre@sterling.ng",phone:"+234 700 7835 7546",website:"www.sterling.ng",address:"20 Marina",city:"Lagos Island, Lagos",colors:{primary:"#00D5FF",secondary:"#FF5C00",rgb:[0,213,255]},tagline:"One Customer, One Bank",watermark:"STERLING BANK"},214:{name:"First City Monument Bank",code:"214",shortName:"FCMB",email:"hello@fcmb.com",phone:"+234 700 329 0000",website:"www.fcmb.com",address:"Primrose Towers, 17A Tinubu Street",city:"Lagos Island, Lagos",colors:{primary:"#6D2077",secondary:"#FDB913",rgb:[109,32,119]},tagline:"The Right Way Forward",watermark:"FCMB"},"032":{name:"Union Bank of Nigeria",code:"032",shortName:"Union",email:"unioncontactcentre@unionbankng.com",phone:"+234 700 700 7000",website:"www.unionbankng.com",address:"Stallion Plaza, 36 Marina",city:"Lagos Island, Lagos",colors:{primary:"#002D5B",secondary:"#00A651",rgb:[0,45,91]},tagline:"Big, Strong, Reliable",watermark:"UNION BANK"},"050":{name:"Ecobank Nigeria",code:"050",shortName:"Ecobank",email:"customercare@ecobank.com",phone:"+234 1 270 9502",website:"www.ecobank.com",address:"21 Ahmadu Bello Way",city:"Victoria Island, Lagos",colors:{primary:"#003399",secondary:"#FF0000",rgb:[0,51,153]},tagline:"The Pan African Bank",watermark:"ECOBANK"},221:{name:"Stanbic IBTC Bank",code:"221",shortName:"Stanbic",email:"contactcentre@stanbicibtc.com",phone:"+234 1 422 2222",website:"www.stanbicibtcbank.com",address:"IBTC Place, Walter Carrington Crescent",city:"Victoria Island, Lagos",colors:{primary:"#0033A1",secondary:"#FFFFFF",rgb:[0,51,161]},tagline:"Moving Forward",watermark:"STANBIC IBTC"}},r={name:"United Bank for Africa",code:"033",shortName:"UBA",email:"contactcentre@ubagroup.com",phone:"+234 700 225 5822",website:"www.ubagroup.com",address:"UBA House, 57 Marina",city:"Lagos Island, Lagos",colors:{primary:"#D4002A",secondary:"#000000",rgb:[212,0,42]},tagline:"Africa's Global Bank",watermark:"UBA"};function l(e,s){if(e&&t[e])return t[e];if(s)return Object.values(t).find(e=>e.name.toLowerCase().includes(s.toLowerCase())||s.toLowerCase().includes(e.shortName.toLowerCase()))||r;return r}},49926:(e,s,a)=>{Promise.resolve().then(a.bind(a,16554))},54679:(e,s,a)=>{"use strict";a.d(s,{Cf:()=>m,Es:()=>x,L3:()=>h,c7:()=>u,lG:()=>i,rr:()=>g,zM:()=>o});var t=a(95155);a(12115);var r=a(89511),l=a(65229),n=a(25016);function i(e){let{...s}=e;return(0,t.jsx)(r.bL,{"data-slot":"dialog",...s})}function o(e){let{...s}=e;return(0,t.jsx)(r.l9,{"data-slot":"dialog-trigger",...s})}function c(e){let{...s}=e;return(0,t.jsx)(r.ZL,{"data-slot":"dialog-portal",...s})}function d(e){let{className:s,...a}=e;return(0,t.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function m(e){let{className:s,children:a,showCloseButton:i=!0,...o}=e;return(0,t.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,t.jsx)(d,{}),(0,t.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...o,children:[a,i&&(0,t.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(l.A,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",s),...a})}function x(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...a})}function h(e){let{className:s,...a}=e;return(0,t.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",s),...a})}function g(e){let{className:s,...a}=e;return(0,t.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",s),...a})}},60125:(e,s,a)=>{"use strict";a.d(s,{A:()=>r});let t=a(95125).A.create({baseURL:"http://localhost:3001/api",timeout:3e4,headers:{"Content-Type":"application/json"}});t.interceptors.request.use(e=>{{let s=localStorage.getItem("accessToken");s&&(e.headers.Authorization="Bearer ".concat(s))}return e},e=>Promise.reject(e)),t.interceptors.response.use(e=>e,async e=>{var s,a,t,r,l,n,i,o;if(!e.response)return Promise.reject(Error("Cannot connect to server. Please ensure the backend is running on http://localhost:3001"));if((null==(s=e.response)?void 0:s.status)!==404){let s=(null==(t=e.response)?void 0:t.status)===401?"\uD83D\uDD12":(null==(r=e.response)?void 0:r.status)===404?"\uD83D\uDD0D":"❌";console.warn("".concat(s," API ").concat(null==(l=e.response)?void 0:l.status,":"),null==(n=e.config)?void 0:n.url,(null==(o=e.response)||null==(i=o.data)?void 0:i.message)||e.message)}return(null==(a=e.response)?void 0:a.status)===401&&(console.log("\uD83D\uDD12 Unauthorized - redirecting to login"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login"),Promise.reject(e)});let r=t},90923:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>c,av:()=>d,j7:()=>o,tU:()=>i});var t=a(95155),r=a(12115),l=a(25667),n=a(25016);let i=l.bL,o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.B8,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});o.displayName=l.B8.displayName;let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.l9,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});c.displayName=l.l9.displayName;let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.UC,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});d.displayName=l.UC.displayName}},e=>{e.O(0,[5125,2663,4909,3358,3148,1691,2518,4657,8687,4744,9829,4081,3087,8441,1255,7358],()=>e(e.s=49926)),_N_E=e.O()}]);
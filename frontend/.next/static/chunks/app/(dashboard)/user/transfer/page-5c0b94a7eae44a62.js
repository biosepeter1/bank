(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9786],{63172:(e,t,a)=>{Promise.resolve().then(a.bind(a,67870))},67870:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(95155),r=a(12115),n=a(83209),i=a(97003),l=a(33789),c=a(90235),o=a(54679),d=a(18085),m=a(56154),u=a(17910),x=a(1524),h=a(19408),p=a(35299),b=a(42529),y=a(8751),N=a(26497),f=a(22663),g=a(38750),j=a(20063),v=a(60125),w=a(86315),A=a(40285);function C(){let{branding:e}=useBranding(),{user:t}=(0,A.n)(),[a,C]=(0,r.useState)(!1),[F,T]=(0,r.useState)(!1),[S,E]=(0,r.useState)(["","","","","",""]),[k,L]=(0,r.useState)(null),[P,R]=(0,r.useState)(0),{currency:I,formatAmount:O}=(0,g.H)(),_=(0,j.useRouter)();(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{var t,a,s;let r=await v.A.get("/auth/me"),n=(null==(t=r.data)?void 0:t.country)||(null==(s=r.data)||null==(a=s.wallet)?void 0:a.currencyCountry);e&&n&&"NG"!==n.toUpperCase()&&_.replace("/user/international")}catch(e){}})(),()=>{e=!1}},[_]);let[q,D]=(0,r.useState)({beneficiaryName:"",accountNumber:"",routingCode:"",amount:"",description:""}),J=async e=>{if(e.preventDefault(),!(null==t?void 0:t.isEmailVerified))return void f.Ay.error("Please verify your email address before making transfers. Check your profile page.");C(!0);try{let e=await v.A.post("/otp/start",{purpose:"TRANSFER",metadata:{amount:Number(q.amount||0),transferType:"LOCAL",beneficiaryName:q.beneficiaryName,beneficiaryAccount:q.accountNumber,bankName:"LOCAL",country:"NG",description:q.description}});L(e.data.otpId),T(!0),R(30);let t=setInterval(()=>R(e=>e<=1?(clearInterval(t),0):e-1),1e3)}catch(e){var a,s;f.Ay.error((null==e||null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to start verification")}finally{C(!1)}},V=async()=>{let e=S.join("");if(6!==e.length)return void f.Ay.error("Please enter complete OTP");if(!k)return void f.Ay.error("Verification has not started");C(!0);try{await v.A.post("/otp/verify",{otpId:k,code:e}),await v.A.post("/transfers/request/local",{recipientAccount:q.accountNumber,amount:Number(q.amount),description:q.description||"Transfer to ".concat(q.beneficiaryName)}),f.Ay.success("Transfer request submitted successfully! Awaiting admin approval."),T(!1),E(["","","","","",""]),D({beneficiaryName:"",accountNumber:"",routingCode:"",amount:"",description:""}),setTimeout(()=>_.push("/user/dashboard"),1500)}catch(e){var t,a;f.Ay.error((null==e||null==(a=e.response)||null==(t=a.data)?void 0:t.message)||"Transfer failed. Please try again.")}finally{C(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[(0,s.jsx)(w.u,{}),(0,s.jsx)(y.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-3 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-lg",children:(0,s.jsx)(d.A,{className:"h-8 w-8 text-white"})}),"Local Transfer"]}),(0,s.jsx)("p",{className:"text-gray-600 mt-3 text-lg",children:"Send money instantly within your country"})]}),(0,s.jsxs)("div",{className:"hidden md:flex gap-4",children:[(0,s.jsxs)("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm",children:[(0,s.jsx)(m.A,{className:"h-6 w-6 text-yellow-500 mx-auto mb-1"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Instant"})]}),(0,s.jsxs)("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm",children:[(0,s.jsx)(u.A,{className:"h-6 w-6 text-green-500 mx-auto mb-1"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Secure"})]}),(0,s.jsxs)("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm",children:[(0,s.jsx)(x.A,{className:"h-6 w-6 text-blue-500 mx-auto mb-1"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Free"})]})]})]})}),(0,s.jsx)(y.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,s.jsxs)(n.Zp,{className:"border-none shadow-xl bg-white/90 backdrop-blur-sm",children:[(0,s.jsxs)(n.aR,{className:"border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:[(0,s.jsxs)(n.ZB,{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-6 w-6 text-blue-600"}),"Transfer Details"]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the recipient's information"})]}),(0,s.jsx)(n.Wu,{className:"pt-6",children:(0,s.jsxs)("form",{onSubmit:J,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.J,{htmlFor:"beneficiaryName",children:"Beneficiary Name"}),(0,s.jsx)(l.p,{id:"beneficiaryName",value:q.beneficiaryName,onChange:e=>D({...q,beneficiaryName:e.target.value}),placeholder:"John Doe",required:!0,className:"mt-1"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.J,{htmlFor:"accountNumber",children:"Account Number / Phone"}),(0,s.jsx)(l.p,{id:"accountNumber",value:q.accountNumber,onChange:e=>D({...q,accountNumber:e.target.value}),placeholder:"0801234567890 or account number",required:!0,className:"mt-1"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter recipient's phone number or account ID"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.J,{htmlFor:"routingCode",children:"Routing Code / Sort Code"}),(0,s.jsx)(l.p,{id:"routingCode",value:q.routingCode,onChange:e=>D({...q,routingCode:e.target.value}),placeholder:"123456789",required:!0,className:"mt-1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(c.J,{htmlFor:"amount",children:["Amount (",I.symbol,")"]}),(0,s.jsx)(l.p,{id:"amount",type:"number",step:"0.01",value:q.amount,onChange:e=>D({...q,amount:e.target.value}),placeholder:"0.00",required:!0,className:"mt-1"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"No fees for local transfers"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.J,{htmlFor:"description",children:"Description (Optional)"}),(0,s.jsx)(l.p,{id:"description",value:q.description,onChange:e=>D({...q,description:e.target.value}),placeholder:"Payment for...",className:"mt-1"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm text-blue-900 mb-2",children:"Transfer Summary"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Amount:"}),(0,s.jsx)("span",{className:"font-semibold",children:O(parseFloat(q.amount||"0")||0)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Transfer Fee:"}),(0,s.jsx)("span",{className:"font-semibold text-green-600",children:"FREE"})]}),(0,s.jsxs)("div",{className:"flex justify-between pt-2 border-t border-blue-200",children:[(0,s.jsx)("span",{className:"text-gray-900 font-semibold",children:"Total:"}),(0,s.jsx)("span",{className:"font-bold text-blue-600",children:O(parseFloat(q.amount||"0")||0)})]})]})]}),(0,s.jsx)(i.$,{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",disabled:a,children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Send Money"]})})]})})]})}),(0,s.jsx)(o.lG,{open:F,onOpenChange:T,children:(0,s.jsxs)(o.Cf,{children:[(0,s.jsxs)(o.c7,{children:[(0,s.jsx)(o.L3,{children:"Verify Transaction"}),(0,s.jsx)(o.rr,{children:"Enter the 6-digit code sent to your email address"})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsx)("div",{className:"flex justify-center gap-2",children:S.map((e,t)=>(0,s.jsx)(l.p,{id:"otp-".concat(t),type:"text",maxLength:1,value:e,onChange:e=>((e,t)=>{if(t.length<=1&&/^\d*$/.test(t)){let a=[...S];if(a[e]=t,E(a),t&&e<5){let t=document.getElementById("otp-".concat(e+1));null==t||t.focus()}}})(t,e.target.value),className:"w-12 h-12 text-center text-lg font-semibold"},t))}),(0,s.jsxs)("div",{className:"text-center text-sm text-gray-600 mt-2",children:["Didn't receive it? ",P>0?(0,s.jsxs)("span",{children:["Resend in ",P,"s"]}):(0,s.jsx)("button",{type:"button",className:"text-blue-600 hover:underline",onClick:async()=>{try{let e=await v.A.post("/otp/start",{purpose:"TRANSFER",metadata:{amount:Number(q.amount||0),transferType:"LOCAL",beneficiaryName:q.beneficiaryName,beneficiaryAccount:q.accountNumber,bankName:"LOCAL",country:"NG",description:q.description}});L(e.data.otpId),E(["","","","","",""]),R(30);let t=setInterval(()=>R(e=>e<=1?(clearInterval(t),0):e-1),1e3);f.Ay.success("Code resent to your email")}catch(a){var e,t;f.Ay.error((null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to resend code")}},children:"Resend to email"})]}),(0,s.jsx)(N.N,{children:6===S.join("").length&&(0,s.jsx)(y.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex justify-center",children:(0,s.jsx)(b.A,{className:"h-12 w-12 text-green-600"})})}),(0,s.jsx)(i.$,{onClick:V,className:"w-full",disabled:a||6!==S.join("").length,children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify & Complete"})]})]})})]})}}},e=>{e.O(0,[5125,2663,4909,3358,3148,1691,4744,7602,5550,8441,1255,7358],()=>e(e.s=63172)),_N_E=e.O()}]);
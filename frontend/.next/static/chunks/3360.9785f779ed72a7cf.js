"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3360],{93360:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(95155),n=s(12115),l=s(26497),o=s(8751),r=s(5937),i=s(14755),c=s(78192),d=s(65229),u=s(20508),m=s(95740),h=s(35299),x=s(18085),p=s(14324),w=s(81738),b=s(60125),y=s(9829);function g(){var e,t,s;let{branding:g}=(0,p.Z)(),{settings:f}=(0,w.t)(),[j,v]=(0,n.useState)(!1),[N,k]=(0,n.useState)([]),[A,I]=(0,n.useState)(""),[D,E]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!0),[L,V]=(0,n.useState)("AI"),[P,q]=(0,n.useState)(null),[z,H]=(0,n.useState)(null),T=(0,n.useRef)(null),_=(null==f||null==(e=f.general)?void 0:e.siteName)||(null==g?void 0:g.name)||"Our Bank",M=(null==f||null==(t=f.general)?void 0:t.supportPhone)||"+234 800 900 7777",R=(null==f||null==(s=f.general)?void 0:s.supportEmail)||"support@bank.com";(0,n.useEffect)(()=>{0===N.length&&k([{id:"1",role:"assistant",content:"Hi there! \uD83D\uDC4B I'm your ".concat(_," assistant. How can I help you today?"),timestamp:new Date}])},[_]),(0,n.useEffect)(()=>()=>{P&&P.disconnect()},[P]),(0,n.useEffect)(()=>{var e;null==(e=T.current)||e.scrollIntoView({behavior:"smooth"})},[N,j]),(0,n.useEffect)(()=>{j&&S(!1)},[j]);let U=()=>{E(!0),P&&P.disconnect();let e=(0,y.io)("http://localhost:3001/live-chat");e.on("connect",()=>{console.log("Connected to live chat"),e.emit("startChat",{userIp:"guest",name:"Guest User"})}),e.on("chatStarted",e=>{H(e.id),E(!1),V("LIVE"),k(e=>[...e,{id:"system-queue-".concat(Date.now()),role:"system",content:"You are now connected to the Live Support queue. An agent will be with you shortly.",timestamp:new Date}])}),e.on("adminJoined",e=>{k(e=>[...e,{id:"system-".concat(Date.now()),role:"system",content:"A support agent has joined the chat.",timestamp:new Date}])}),e.on("newMessage",e=>{"USER"!==e.sender&&k(t=>[...t,{id:e.id,role:"ADMIN"===e.sender?"assistant":"system",content:e.message,timestamp:new Date(e.createdAt)}])}),e.on("sessionEnded",()=>{k(e=>[...e,{id:"system-end-".concat(Date.now()),role:"system",content:"The chat session has ended. You can continue with our AI assistant or start a new live chat.",timestamp:new Date}]),V("AI"),H(null),e.disconnect(),q(null)}),q(e)},B=async()=>{if(!A.trim()||D)return;let e=A.trim();I("");let t={id:Date.now().toString(),role:"user",content:e,timestamp:new Date};if(k(e=>[...e,t]),"LIVE"===L&&P&&z)P.emit("sendMessage",{sessionId:z,message:e,sender:"USER"});else{E(!0);try{let t=N.filter(e=>"system"!==e.role).map(e=>({role:"assistant"===e.role?"model":"user",parts:[{text:e.content}]})),s=await b.A.post("/chat/ai",{message:e,history:t,siteName:_,supportPhone:M,supportEmail:R}),a={id:(Date.now()+1).toString(),role:"assistant",content:s.data.response||"I apologize, but I couldn't process your request.",timestamp:new Date};k(e=>[...e,a])}catch(e){console.error("Chatbot error:",e),k(e=>[...e,{id:(Date.now()+1).toString(),role:"assistant",content:"I'm having trouble connecting right now.",timestamp:new Date}])}finally{E(!1)}}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.N,{children:!j&&(0,a.jsxs)(o.P.button,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>v(!0),className:"fixed bottom-6 right-6 z-50 w-14 h-14 rounded-full shadow-2xl flex items-center justify-center text-white group",style:{background:"linear-gradient(135deg, ".concat(g.colors.primary," 0%, ").concat(g.colors.secondary," 100%)")},children:[(0,a.jsx)(r.A,{className:"w-6 h-6"}),C&&(0,a.jsx)("span",{className:"absolute inset-0 rounded-full animate-ping opacity-30",style:{background:g.colors.primary}}),(0,a.jsx)("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-1.5 bg-slate-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Chat with us"})]})}),(0,a.jsx)(l.N,{children:j&&(0,a.jsxs)(o.P.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-6 right-6 z-50 w-[380px] h-[600px] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-slate-100",children:[(0,a.jsxs)("div",{className:"p-4 text-white relative overflow-hidden flex-shrink-0",style:{background:"linear-gradient(135deg, ".concat(g.colors.primary," 0%, ").concat(g.colors.secondary," 100%)")},children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,a.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white rounded-full blur-2xl"})}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:"LIVE"===L?(0,a.jsx)(i.A,{className:"w-5 h-5 text-white"}):g.logo?(0,a.jsx)("img",{src:g.logo,alt:"",className:"w-6 h-6 object-contain"}):(0,a.jsx)(c.A,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-base",children:"LIVE"===L?"Live Support":"".concat(_," Assistant")}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-white/80",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full animate-pulse ".concat("LIVE"===L?"bg-green-400":"bg-blue-300")}),"LIVE"===L?"Connected to Agent":"AI Powered"]})]})]}),(0,a.jsx)("button",{onClick:()=>v(!1),className:"p-1.5 hover:bg-white/20 rounded-full transition-colors",children:(0,a.jsx)(d.A,{className:"w-5 h-5"})})]}),"AI"===L&&(0,a.jsxs)("button",{onClick:U,className:"w-full mt-2 py-1.5 px-3 bg-white/10 hover:bg-white/20 rounded-lg text-xs font-medium flex items-center justify-center gap-2 transition-colors border border-white/10",children:[(0,a.jsx)(i.A,{className:"w-3.5 h-3.5"}),"Speak with a human agent"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-to-b from-slate-50 to-white",children:[N.map(e=>(0,a.jsx)(o.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-2 ".concat("user"===e.role?"flex-row-reverse":""," ").concat("system"===e.role?"justify-center !mb-2":""),children:"system"===e.role?(0,a.jsx)("span",{className:"text-[10px] uppercase font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded-full tracking-wider",children:e.content}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat("user"===e.role?"bg-slate-200 text-slate-600":""),style:"assistant"===e.role?{background:"linear-gradient(135deg, ".concat(g.colors.primary," 0%, ").concat(g.colors.secondary," 100%)")}:{},children:"user"===e.role?(0,a.jsx)(u.A,{className:"w-4 h-4"}):"LIVE"===L?(0,a.jsx)(i.A,{className:"w-4 h-4 text-white"}):(0,a.jsx)(m.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("div",{className:"max-w-[75%] px-4 py-2.5 rounded-2xl text-sm leading-relaxed ".concat("user"===e.role?"bg-slate-800 text-white rounded-br-md":"bg-white shadow-md border border-slate-100 rounded-bl-md text-slate-700"),children:e.content})]})},e.id)),D&&(0,a.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, ".concat(g.colors.primary," 0%, ").concat(g.colors.secondary," 100%)")},children:(0,a.jsx)(m.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("div",{className:"bg-white shadow-md border border-slate-100 rounded-2xl rounded-bl-md px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,a.jsx)("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,a.jsx)("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),(0,a.jsx)("div",{ref:T})]}),"AI"===L&&(0,a.jsx)("div",{className:"px-4 py-2 border-t border-slate-100 bg-slate-50",children:(0,a.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[(0,a.jsx)("button",{onClick:()=>I("How do I open an account?"),className:"px-3 py-1.5 text-xs font-medium rounded-full bg-white border border-slate-200 hover:border-slate-300 text-slate-600 hover:text-slate-800 transition-colors whitespace-nowrap",children:"Open account"}),(0,a.jsx)("button",{onClick:()=>I("What are your loan options?"),className:"px-3 py-1.5 text-xs font-medium rounded-full bg-white border border-slate-200 hover:border-slate-300 text-slate-600 hover:text-slate-800 transition-colors whitespace-nowrap",children:"Loans"}),(0,a.jsx)("button",{onClick:U,className:"px-3 py-1.5 text-xs font-medium rounded-full bg-white border border-slate-200 hover:border-slate-300 text-slate-600 hover:text-slate-800 transition-colors whitespace-nowrap",children:"Live support"})]})}),(0,a.jsxs)("div",{className:"p-4 border-t border-slate-100 bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"text",value:A,onChange:e=>I(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),B())},placeholder:"LIVE"===L?"Type a message to support...":"Type a message...",disabled:D,className:"flex-1 px-4 py-2.5 bg-slate-100 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-offset-1 transition-all disabled:opacity-50",style:{"--tw-ring-color":g.colors.primary}}),(0,a.jsx)("button",{onClick:B,disabled:!A.trim()||D,className:"w-10 h-10 rounded-xl text-white flex items-center justify-center transition-all disabled:opacity-50 disabled:cursor-not-allowed hover:opacity-90",style:{background:"linear-gradient(135deg, ".concat(g.colors.primary," 0%, ").concat(g.colors.secondary," 100%)")},children:D?(0,a.jsx)(h.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.A,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"text-[10px] text-slate-400 text-center mt-2",children:"LIVE"===L?"Chats may be recorded for quality assurance.":(0,a.jsxs)("span",{children:["Powered by AI â€¢ ",(0,a.jsx)("a",{href:"/contact",className:"hover:underline",style:{color:g.colors.primary},children:"Contact Support"})]})})]})]})})]})}}}]);